import base64
exec(base64.b64decode('IyEvdXNyL2Jpbi9weXRob24zCiMgLSotIGNvZGluZzp1dGYtOCAtKi0KaW1wb3J0IHN1YnByb2Nlc3MKaW1wb3J0IG9zCmltcG9ydCB0cmFjZWJhY2sKaW1wb3J0IHNodXRpbApmcm9tIHhtbC5kb20ubWluaWRvbSBpbXBvcnQgcGFyc2UKaW1wb3J0IHhtbC5kb20ubWluaWRvbQpmcm9tIGxpYi5pbmZvIGltcG9ydCBJbmZvCmZyb20gbGliLnRvb2xzIGltcG9ydCAqCgpzY2FubmVycyA9IHt9CgoKZGVmIHJlZ2lzdGVyKHNjYW5uZXJfY2xhc3MpOgogICAgc2Nhbm5lcnNbc2Nhbm5lcl9jbGFzcy5fX25hbWVfX10gPSBzY2FubmVyX2NsYXNzCgoKZGVmIHNjYW5uZXIoc2Nhbm5lcl9rZXkpOgogICAgc2Nhbm5lcl9jbGFzcyA9IHNjYW5uZXJzLmdldChzY2FubmVyX2tleSwgTm9uZSkKICAgIGlmIHNjYW5uZXJfY2xhc3MgaXMgTm9uZToKICAgICAgICByZXR1cm4gTm9uZQogICAgcmV0dXJuIHNjYW5uZXJfY2xhc3MKCgpkZWYgaW1wb3J0X3NjYW5uZXJzKHNjYW5uZXJzX2ltcG9ydHMpOgogICAgZm9yIHJ1bm5lcl9pbXBvcnQgaW4gc2Nhbm5lcnNfaW1wb3J0czoKICAgICAgICBfX2ltcG9ydF9fKHJ1bm5lcl9pbXBvcnQpCgoKZnJvbSAuIGltcG9ydCBBbmRyb2lkICAgIyBFeGVjdXRlIGltcG9ydCBwYWNrYWdlIHRvIHNjYW5uZXJzCgoKZGVmIGFwa1NjYW4oaW5wdXRmaWxlLCBzYXZlKToKICAgICMgVW56aXAgdGhlIGFwayBwYWNrYWdlCiAgICBjb25zb2xlLnByaW50KCdcblttYWdlbnRhXVVuemlwIGFwayBbL21hZ2VudGFdW2JvbGQgbWFnZW50YV0nICsgaW5wdXRmaWxlICsgJ1svYm9sZCBtYWdlbnRhXScpCiAgICBmaWxlUGF0aCA9IGlucHV0ZmlsZS5yZXBsYWNlKCcuYXBrJywgJycpLnNwbGl0KCcvJylbLTFdICsgcmFuZG9tU3RyKDYpCiAgICBzdHJsaW5lID0gJ2Fwa3Rvb2wgZCAtZiAiJyArIGlucHV0ZmlsZSArICciIC1vICcgKyBmaWxlUGF0aCArICcgLS1vbmx5LW1haW4tY2xhc3NlcycKICAgIHN1YnByb2Nlc3MuUG9wZW4oc3RybGluZSwgc2hlbGw9VHJ1ZSkuY29tbXVuaWNhdGUoKQogICAgY29uc29sZS5wcmludCgnW2JvbGQgZ3JlZW5dRmluaXNoWy9ib2xkIGdyZWVuXScpCiAgICBmaWxlUGF0aCA9IG9zLnBhdGguYWJzcGF0aChmaWxlUGF0aCkKICAgIHRyeToKICAgICAgICBhcGtJbmZvKGZpbGVQYXRoKQogICAgICAgIHBlcm1pc3Npb25BbmRFeHBvcnQoZmlsZVBhdGgpCiAgICAgICAgYXBwU2lnbihpbnB1dGZpbGUpCiAgICAgICAgZmluZ2VyUHJpbnQoZmlsZVBhdGgpCgogICAgICAgIGZvciBrZXkgaW4gc2Nhbm5lcnMua2V5cygpOgogICAgICAgICAgICBjID0gc2Nhbm5lcihrZXkpCiAgICAgICAgICAgIGlmIGM6CiAgICAgICAgICAgICAgICBjKGZpbGVQYXRoKS5zY2FuKCkKICAgIGV4Y2VwdDoKICAgICAgICBwcmludCh0cmFjZWJhY2suZm9ybWF0X2V4YygpKQoKICAgIGlmIG5vdCBzYXZlOgogICAgICAgIGNvbnNvbGUucHJpbnQoJ1xuW2JvbGQgbWFnZW50YV1DbGVhbiBjYWNoZS4uLlsvYm9sZCBtYWdlbnRhXScpCiAgICAgICAgc2h1dGlsLnJtdHJlZShmaWxlUGF0aCkKICAgICAgICBjb25zb2xlLnByaW50KCdbYm9sZCBncmVlbl1GaW5pc2hbL2JvbGQgZ3JlZW5dJykKICAgIAoKZGVmIGFwcFNpZ24oZmlsZVBhdGgpOgogICAgc3RybGluZSA9ICdhcGtzaWduZXIgdmVyaWZ5IC12IC0tcHJpbnQtY2VydHMgJyArIGZpbGVQYXRoCiAgICBwID0gc3VicHJvY2Vzcy5Qb3BlbihzdHJsaW5lLCBzaGVsbD1UcnVlLCBzdGRvdXQ9c3VicHJvY2Vzcy5QSVBFLCBzdGRlcnI9c3VicHJvY2Vzcy5QSVBFKQogICAgc3RkID0gcC5jb21tdW5pY2F0ZSgpCiAgICBhcnIgPSBzdGRbMF0uZGVjb2RlKCd1dGYtOCcsICdyZXBsYWNlJykuc3BsaXQoJ1xuJykKICAgIHJlc3VsdCA9ICcnCiAgICBmb3IgbGluZSBpbiBhcnI6CiAgICAgICAgaWYgJ1dBUk5JTkc6JyBub3QgaW4gbGluZToKICAgICAgICAgICAgcmVzdWx0ICs9IGxpbmUgKyAnXG4nCiAgICBJbmZvKHRpdGxlPSdTaWduYXR1cmUgaW5mb3JtYXRpb24nLCBsZXZlbD0wLCBpbmZvPSdTaWduYXR1cmUgdmVyaWZpY2F0aW9uIGRldGFpbHMnLCByZXN1bHQ9cmVzdWx0KS5kZXNjcmlwdGlvbigpCgoKZGVmIGZpbmdlclByaW50KGZpbGVQYXRoKToKICAgIHN0cmxpbmUgPSAnY2QgJyArIGZpbGVQYXRoICsgJy9vcmlnaW5hbC9NRVRBLUlORiAmJiAobHMgfCBncmVwICouUlNBKScKICAgIG91dCA9IG9zLnBvcGVuKHN0cmxpbmUpLnJlYWRsaW5lcygpCiAgICByc2EgPSAnJwogICAgZm9yIGxpbmUgaW4gb3V0OgogICAgICAgIHJzYSA9IGxpbmVbOi0xXS5sc3RyaXAoKQogICAgc3RybGluZSA9ICdrZXl0b29sIC1wcmludGNlcnQgLWZpbGUgJyArIGZpbGVQYXRoICsgJy9vcmlnaW5hbC9NRVRBLUlORi8nICsgcnNhCiAgICBvdXQgPSBvcy5wb3BlbihzdHJsaW5lKS5yZWFkbGluZXMoKQogICAgcmVzdWx0ID0gJycKICAgIGZvciBsaW5lIGluIG91dDoKICAgICAgICByZXN1bHQgKz0gbGluZQogICAgSW5mbyh0aXRsZT0nQ2VydGlmaWNhdGUgZmluZ2VycHJpbnQnLCBsZXZlbD0wLCBpbmZvPSdDZXJ0aWZpY2F0ZSBmaW5nZXJwcmludCBpbmZvcm1hdGlvbicsIHJlc3VsdD1yZXN1bHQpLmRlc2NyaXB0aW9uKCkKCgpkZWYgcGVybWlzc2lvbkFuZEV4cG9ydChmaWxlUGF0aCk6CiAgICBYTUxQYXRoID0gZmlsZVBhdGggKyAnL0FuZHJvaWRNYW5pZmVzdC54bWwnCiAgICByZXN1bHQgPSAnJwogICAgdHJlZSA9IHhtbC5kb20ubWluaWRvbS5wYXJzZShYTUxQYXRoKQogICAgcm9vdCA9IHRyZWUuZG9jdW1lbnRFbGVtZW50CiAgICBwYWNrYWdlID0gcm9vdC5nZXRBdHRyaWJ1dGUoJ3BhY2thZ2UnKQogICAgcmVzdWx0ICs9ICcgIFBhY2thZ2UgbmFtZTogJyArIHBhY2thZ2UKICAgIHJlc3VsdCArPSAnXG4gIFVzZSBwZXJtaXNzaW9uIGxpc3QnCiAgICBwZXJtaXNzaW9uTGlzdCA9IHJvb3QuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3VzZXMtcGVybWlzc2lvbicpCiAgICBmb3IgcCBpbiBwZXJtaXNzaW9uTGlzdDoKICAgICAgICByZXN1bHQgKz0gJ1xuICAgICAgJyArIHAuZ2V0QXR0cmlidXRlKCdhbmRyb2lkOm5hbWUnKQogICAgcGVybWlzc2lvbkxpc3QgPSByb290LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdwZXJtaXNzaW9uJykKICAgIGZvciBwIGluIHBlcm1pc3Npb25MaXN0OgogICAgICAgIHJlc3VsdCArPSAnXG4gICAgICAnICsgcC5nZXRBdHRyaWJ1dGUoJ2FuZHJvaWQ6bmFtZScpCiAgICBJbmZvKHRpdGxlPSdQZXJtaXNzaW9uIGluZm9ybWF0aW9uJywgbGV2ZWw9MCwgaW5mbz0nQXBwbGljYXRpb24gcGVybWlzc2lvbiBpbmZvcm1hdGlvbicsIHJlc3VsdD1yZXN1bHQpLmRlc2NyaXB0aW9uKCkKICAgIHJlc3VsdHMgPSBbXQogICAgZXhwb3J0ZWRMaXN0ID0gcm9vdC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYWN0aXZpdHktYWxpYXMnKSArIHJvb3QuZ2V0RWxlbWVudHNCeVRhZ05hbWUoCiAgICAgICAgJ2FjdGl2aXR5JykgKyByb290LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzZXJ2aWNlJykgKyByb290LmdldEVsZW1lbnRzQnlUYWdOYW1lKAogICAgICAgICdyZWNlaXZlcicpICsgcm9vdC5nZXRFbGVtZW50c0J5VGFnTmFtZSgncHJvdmlkZXInKQogICAgZm9yIGEgaW4gZXhwb3J0ZWRMaXN0OgogICAgICAgIGlmIGEuZ2V0QXR0cmlidXRlKCdhbmRyb2lkOmV4cG9ydGVkJykgPT0gJ3RydWUnOgogICAgICAgICAgICBwID0gYS5nZXRBdHRyaWJ1dGUoJ2FuZHJvaWQ6bmFtZScpCiAgICAgICAgICAgIHJlc3VsdHMuYXBwZW5kKHApCiAgICBJbmZvKHRpdGxlPSdDb21wb25lbnQgZXhwb3J0IGRldGVjdGlvbicsIGxldmVsPTAsIGluZm89J0RldGVjdCBleHBvcnRlZCBjb21wb25lbnQgaW5mb3JtYXRpb24nLCByZXN1bHQ9IlxuIi5qb2luKHJlc3VsdHMpKS5kZXNjcmlwdGlvbigpCgoKZGVmIGFwa0luZm8oZmlsZVBhdGgpOgogICAgeW1sID0gZmlsZVBhdGggKyAnL2Fwa3Rvb2wueW1sJwogICAgcmVzdWx0ID0gJycKICAgIHdpdGggb3Blbih5bWwsIG1vZGU9J3InKSBhcyBmOgogICAgICAgIGlvID0gZi5yZWFkKCkKICAgICAgICBzdHJBcnIgPSBzdHIoaW8pLnNwbGl0KCdcbicpCiAgICAgICAgZm9yIHMgaW4gc3RyQXJyOgogICAgICAgICAgICBpZiAnbWluU2RrVmVyc2lvbicgaW4gczoKICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnICBtaW5TZGtWZXJzaW9uOiAnICsgcy5zcGxpdCgnOicpWy0xXS5sc3RyaXAoKS5yZXBsYWNlKCInIiwgJycpCiAgICAgICAgICAgIGlmICd0YXJnZXRTZGtWZXJzaW9uJyBpbiBzOgogICAgICAgICAgICAgICAgcmVzdWx0ICs9ICdcbiAgU0RLIHZlcnNpb246ICcgKyBzLnNwbGl0KCc6JylbLTFdLmxzdHJpcCgpLnJlcGxhY2UoIiciLCAnJykKICAgICAgICAgICAgaWYgJ3ZlcnNpb25Db2RlJyBpbiBzOgogICAgICAgICAgICAgICAgcmVzdWx0ICs9ICdcbiAgVmVyc2lvbiBudW1iZXI6ICcgKyBzLnNwbGl0KCc6JylbLTFdLmxzdHJpcCgpLnJlcGxhY2UoIiciLCAnJykKICAgICAgICAgICAgaWYgJ3ZlcnNpb25OYW1lJyBpbiBzOgogICAgICAgICAgICAgICAgcmVzdWx0ICs9ICdcbiAgVmVyc2lvbiBuYW1lOiAnICsgcy5zcGxpdCgnOicpWy0xXS5sc3RyaXAoKS5yZXBsYWNlKCInIiwgJycpCiAgICBJbmZvKHRpdGxlPSdCYXNpYyBhcHBsaWNhdGlvbiBpbmZvcm1hdGlvbicsIGxldmVsPTAsIGluZm89J0Jhc2ljIGluZm9ybWF0aW9uIG9mIHRoZSBhcHAnLCByZXN1bHQ9cmVzdWx0KS5kZXNjcmlwdGlvbigpCg=='))